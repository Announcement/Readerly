{"version":3,"file":"build.js","sources":["library/display.js","main.js"],"sourcesContent":["// let shadow = ['0', '0', '2px', rgba(128, 128, 128, 0.87)]\r\nlet $browser = chrome || browser\r\n\r\nlet rewindImageSource\r\nlet settingsImageSource\r\n// let spriteImage\r\n\r\nfunction url (it) {\r\n  if (typeof browser === 'undefined') {\r\n    return chrome.runtime.getURL(it)\r\n  } else {\r\n    return browser.extension.getURL(it)\r\n  }\r\n}\r\n\r\nsettingsImageSource = url('images/settings.png')\r\nrewindImageSource = url('images/rewind.png')\r\n// spriteImage = url('images/sprites.png')\r\n\r\nconsole.log(settingsImageSource)\r\nconsole.log(rewindImageSource)\r\n\r\nfunction shadow (elevation) {\r\n  let sketch\r\n\r\n  sketch = {}\r\n\r\n  sketch['2dp'] =\r\n    [\r\n      ['0', '0', '4px', rgba(0, 0, 0, .14)],\r\n      ['0', '3px', '4px', rgba(0, 0, 0, .12)],\r\n      ['0', '1px', '5px', rgba(128, 128, 128, .20)]\r\n    ].map(it => it.join(' ')).join(', ')\r\n\r\n  return sketch[elevation]\r\n}\r\n\r\nlet stylesheet = {\r\n  position: 'fixed',\r\n  top: '0',\r\n  left: '0',\r\n  width: '100%',\r\n  height: '80px',\r\n  background: rgba(255, 255, 255, 0.8),\r\n  boxShadow: shadow('2dp'),\r\n  display: 'grid',\r\n  justifyItems: 'center',\r\n  alignItems: 'center',\r\n  gridTemplateRows: '4px 1fr',\r\n  gridTemplateColumns: '24px min-content min-content 1fr min-content 24px',\r\n  gridColumnGap: '8px',\r\n  progress: {\r\n    gridColumnStart: '1',\r\n    gridColumnEnd: 'span 6',\r\n    width: '100%',\r\n    height: '100%',\r\n    WebkitAppearance: 'none',\r\n    background: 'white',\r\n  },\r\n  button: {\r\n    height: '36px',\r\n    borderRadius: '2px',\r\n    paddingLeft: '16px',\r\n    paddingRight: '16px',\r\n    outline: 'none',\r\n    borderStyle: 'solid',\r\n    borderColor: 'transparent',\r\n    borderWidth: '0',\r\n    minWidth: '88px',\r\n    boxShadow: shadow('2dp'),\r\n    // marginTop: 'auto',\r\n    // marginLeft: '8px',\r\n    // marginRight: '8px',\r\n    // marginBottom: 'auto'\r\n  },\r\n  'button.settings': {\r\n    gridColumnStart: '2',\r\n    gridColumnEnd: 'span 1',\r\n    // height: '36px',\r\n    // width: '36px',\r\n    backgroundImage: `url(\"${settingsImageSource}\")`,\r\n    backgroundSize: '32px 32px',\r\n    // backgroundColor: 'transparent',\r\n    backgroundRepeat: 'no-repeat',\r\n    backgroundPosition: 'center',\r\n    minWidth: '36px',\r\n    width: `${36 + 16 * 2}px`,\r\n    content: '',\r\n    color: 'transparent'\r\n  },\r\n  'button.speed': {\r\n    gridColumnStart: '3',\r\n    gridColumnEnd: 'span 1',\r\n    // height: '36px',\r\n    // width: '36px',\r\n    backgroundImage: `url(\"${rewindImageSource}\")`,\r\n    backgroundSize: '32px 32px',\r\n    // backgroundColor: 'transparent',\r\n    backgroundRepeat: 'no-repeat',\r\n    backgroundPosition: 'center',\r\n    minWidth: '36px',\r\n    width: `${36 + 16 * 2}px`,\r\n    content: '',\r\n    color: 'transparent'\r\n  },\r\n  'button.close': {},\r\n}\r\n\r\nfunction rgba(red, green, blue, alpha) {\r\n  return `rgba(${red}, ${green}, ${blue}, ${alpha})`\r\n}\r\n\r\nclass Display {\r\n  constructor () {\r\n    this.filter = new WeakMap()\r\n    this.zIndex = new WeakMap()\r\n\r\n    this.element = this.generate()\r\n\r\n    Display.styleize(this.element, stylesheet)\r\n\r\n    console.log(this.element)\r\n  }\r\n\r\n  generate () {\r\n    let element\r\n    let progressElement\r\n    let settingsElement\r\n    let speedElement\r\n    let playbackElement\r\n    let closeElement\r\n    let checkElement\r\n\r\n    let settingsText\r\n    let speedText\r\n    let closeText\r\n\r\n    element = document.createElement('section')\r\n\r\n    progressElement = document.createElement('progress')\r\n    settingsElement = document.createElement('button')\r\n    speedElement = document.createElement('button')\r\n    closeElement = document.createElement('button')\r\n    checkElement = document.createElement('input')\r\n    playbackElement = document.createElement('div')\r\n\r\n    settingsText = document.createTextNode('Settings')\r\n    speedText = document.createTextNode('Speed')\r\n    closeText = document.createTextNode('Close')\r\n\r\n    settingsElement.appendChild(settingsText)\r\n    speedElement.appendChild(speedText)\r\n    closeElement.appendChild(closeText)\r\n\r\n    element.appendChild(progressElement)\r\n    element.appendChild(settingsElement)\r\n    element.appendChild(speedElement)\r\n    element.appendChild(playbackElement)\r\n    element.appendChild(closeElement)\r\n\r\n    // settingsElement.setAttribute('src', settingsImageSource)\r\n    // speedElement.setAttribute('src', rewindImageSource)\r\n    // element.appendChild(checkElement)\r\n\r\n    // checkElement.setAttribute('type', 'checkbox')\r\n    progressElement.setAttribute('value', '50')\r\n    progressElement.setAttribute('max', '100')\r\n\r\n    settingsElement.classList.add('settings')\r\n    speedElement.classList.add('speed')\r\n    playbackElement.classList.add('playback')\r\n    closeElement.classList.add('close')\r\n    // checkElement.classList.add('check')\r\n\r\n    settingsElement.addEventListener('click', () => this._settings())\r\n    speedElement.addEventListener('click', () => this._speed())\r\n    closeElement.addEventListener('click', () => this._close())\r\n\r\n    element.id = 'readerly'\r\n\r\n    function scope (element) {\r\n      let index\r\n\r\n      element.classList.add('readerly')\r\n      element.style.initial = 'all'\r\n\r\n      for (index = 0; index < element.children.length; index++) {\r\n        scope(element.children[index])\r\n      }\r\n    }\r\n\r\n    scope(element)\r\n\r\n    return element\r\n  }\r\n\r\n  _settings () {}\r\n  _speed () {}\r\n  _close () {\r\n    this.blur()\r\n    this.close()\r\n  }\r\n\r\n  close () {\r\n    document.body.removeChild(this.element)\r\n  }\r\n\r\n  open () {\r\n    document.body.appendChild(this.element)\r\n  }\r\n\r\n  static styleize (it, styles) {\r\n    if (!it) return false\r\n\r\n    let stylesheetElement\r\n    let stylesheetNode\r\n\r\n    stylesheetElement = document.createElement('style')\r\n\r\n    document.head.appendChild(stylesheetElement)\r\n\r\n    stylesheetNode = document.styleSheets[document.styleSheets.length - 1]\r\n\r\n    this.stylesheet = stylesheetNode\r\n\r\n    // these are to override the default progress bar in chrome since they look like garbage.\r\n    this.stylesheet.insertRule('progress::-webkit-progress-bar { background: #8C9EFF; }')\r\n    this.stylesheet.insertRule('progress::-webkit-progress-value { background: #3D5AFE; }')\r\n\r\n    Object.keys(styles).forEach(key => {\r\n      let value\r\n\r\n      value = styles[key]\r\n      if (value.constructor === Array) {\r\n        value = value.join(' ')\r\n      }\r\n\r\n      assign(key, value)\r\n      find(key, value)\r\n    })\r\n\r\n    function assign (key, value) {\r\n      key = key.replace(/([A-Z])/g, it => '-' + it.toLowerCase())\r\n\r\n      if (typeof value === 'string') {\r\n        it.style[key] = value\r\n      }\r\n    }\r\n\r\n    function find (key, value) {\r\n      if (typeof value === 'object') {\r\n        it.querySelectorAll(key).forEach(it => Display.styleize(it, value))\r\n      }\r\n    }\r\n  }\r\n\r\n  focus () {\r\n    let zIndexMaximum\r\n\r\n    zIndexMaximum = 0\r\n\r\n    document.querySelectorAll('body > *').forEach(it => {\r\n      if (it !== this.element) {\r\n        this.filter.set(it, it.style.filter)\r\n        it.style.filter = 'blur(4px)'\r\n      }\r\n    })\r\n\r\n    document.querySelectorAll('body *').forEach(it => {\r\n      if (it !== this.element && it.style['z-index']) {\r\n        zIndexMaximum = Math.max(parseInt(it.style['z-index'], 10), zIndexMaximum)\r\n      }\r\n    })\r\n\r\n    this.element.style['z-index'] = zIndexMaximum + 1\r\n  }\r\n\r\n  blur () {\r\n    document.querySelectorAll('body > *').forEach(it => {\r\n      if (this.filter.has(it)) {\r\n        it.style.filter = this.filter.get(it)\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\n\r\nexport default Display\r\n","import Display from './library/display'\r\n\r\nlet $browser\r\nlet display\r\n\r\n$browser = chrome || browser\r\n\r\nconsole.debug('Waiting for the document.')\r\n\r\ndocument.addEventListener('DOMContentLoaded', function () {\r\n  display = new Display()\r\n})\r\n\r\n$browser.runtime.onMessage.addListener(message)\r\n\r\nfunction message (it) {\r\n  display.open()\r\n  display.focus()\r\n}\r\n"],"names":["rewindImageSource","settingsImageSource","url","it","browser","chrome","runtime","getURL","extension","console","log","shadow","elevation","sketch","rgba","map","join","stylesheet","red","green","blue","alpha","Display","filter","WeakMap","zIndex","element","generate","styleize","progressElement","settingsElement","speedElement","playbackElement","closeElement","checkElement","settingsText","speedText","closeText","document","createElement","createTextNode","appendChild","setAttribute","classList","add","addEventListener","_settings","_speed","_close","id","scope","index","style","initial","children","length","blur","close","body","removeChild","zIndexMaximum","querySelectorAll","forEach","set","Math","max","parseInt","has","get","styles","stylesheetElement","stylesheetNode","head","styleSheets","insertRule","keys","value","key","constructor","Array","assign","replace","toLowerCase","find","$browser","display","debug","onMessage","addListener","message","open","focus"],"mappings":"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"}